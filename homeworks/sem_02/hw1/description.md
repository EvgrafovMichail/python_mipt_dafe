# –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ: –ê–ª–≥–æ—Ä–∏—Ç–º—ã –∏ –≤—Å–µ, —á—Ç–æ —Ä—è–¥–æ–º

–°–∞–º–æ–µ –≤—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—ã —É–∑–Ω–∞–ª–∏ –≤ —ç—Ç–æ–º —Å–µ–º–µ—Å—Ç—Ä–µ. –í –¥–∞–Ω–Ω–æ–π –¥–æ–º–∞—à–Ω–µ–º –∑–∞–¥–∞–Ω–∏–∏, –º—ã —Å –≤–∞–º–∏ –Ω–∞–ø–∏—à–µ–º –Ω–µ–±–æ–ª—å—à–æ–π –º–æ–¥—É–ª—å –¥–ª—è –Ω–∞—É—á–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö. –Ø –ø–∏—à—É "–º—ã", —á—Ç–æ–±—ã –≤–∞–º –Ω–µ –±—ã–ª–æ —Ç–∞–∫ –æ–¥–∏–Ω–æ–∫–æ —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ. –ù–∞—à –º–æ–¥—É–ª—å –±—É–¥–µ—Ç –≤–∫–ª—é—á–∞—Ç—å —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á [–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏](http://www.machinelearning.ru/wiki/index.php?title=%D0%9A%D0%BB%D0%B0%D1%81%D1%81%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D1%8F), —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.

## –î–∞–Ω–Ω—ã–µ

–í –¥–∞–Ω–Ω–æ–º –∑–∞–¥–∞–Ω–∏–∏ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–≥—Ä—É—à–µ—á–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ –º–æ–¥—É–ª—è `ScikitLearn`.

``` python 
points, labels = skd.make_moons(n_samples=400, noise=0.3)
```

![dataset](./images/dataset.png)

*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:* —Å—Ä–∞–∑—É —Å—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –∏ —Å –¥—Ä—É–≥–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

## –ê–Ω–∞–ª–∏–∑ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–í –Ω–∞—á–∞–ª–µ —Ä–µ—à–µ–Ω–∏—è –ª—é–±–æ–π –∑–∞–¥–∞—á–∏ –∏–∑ —Å—Ñ–µ—Ä—ã –Ω–∞—É–∫–∏ –æ –¥–∞–Ω–Ω—ã—Ö, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ü–µ–Ω–∏—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –ø–æ–Ω—è—Ç—å, –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —è–≤–ª—è—é—Ç—Å—è –ø—Ä–∏–µ–º–ª–µ–º—ã–º–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö —Ä–∞—Å—á–µ—Ç–æ–≤, –∞ –∫–∞–∫–∏–µ - –∞–Ω–æ–º–∞–ª—å–Ω—ã–º–∏, –≤—ã–±—Ä–æ—Å–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ—Ä—Ç—è—Ç —Ä–∞–±–æ—Ç—É –Ω–∞—à–µ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞. –î–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —Å–º–æ–∂–µ—Ç –≥–∏–±–∫–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –≤ –Ω–∞–±–æ—Ä–µ –¥–≤—É–º–µ—Ä–Ω—ã—Ö —Ç–æ—á–µ–∫. 

```python
class AxisNames(StrEnum):
    X = ""
    Y = ""

class DiagramTypes(StrEnum):
    Violin = ""
    Hist = ""
    Boxplot = ""

def visualize_distribution(
    points: np.ndarray,
    diagram_type: Union[DiagramTypes, list[DiagramTypes]],
    diagram_axis: Union[AxisNames, list[AxisNames]],
    path_to_save: str = "",
) -> None:
    ...
```
–§—É–Ω–∫—Ü–∏—è `visualize_distribution` —Å—Ç—Ä–æ–∏—Ç —Å–µ—Ç–∫—É –≥—Ä–∞—Ñ–∏–∫–æ–≤, –≥–¥–µ —Å—Ç—Ä–æ–∫–∏ ‚Äî —Ç–∏–ø—ã –¥–∏–∞–≥—Ä–∞–º–º (`violin`, `hist`, `boxplot`), –∞ —Å—Ç–æ–ª–±—Ü—ã ‚Äî –æ—Å–∏ (`x`, `y`). –ì—Ä–∞—Ñ–∏–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è –∏ –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç—Å—è.

–í—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `points` (np.ndarray) ‚Äî –º–∞—Å—Å–∏–≤ NumPy —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ (N, 2), –≥–¥–µ –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–µ x, –∞ –≤—Ç–æ—Ä–æ–π ‚Äî y;
- `diagram_type` ‚Äî —Ç–∏–ø –¥–∏–∞–≥—Ä–∞–º–º—ã (–∏–ª–∏ —Å–ø–∏—Å–æ–∫ —Ç–∏–ø–æ–≤), –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å. –î–æ—Å—Ç—É–ø–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:
    - `Violin` - —è—â–∏–∫ —Å —É—Å–∞–º–∏ + –ø–ª–æ—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è;
    - `Hist` - –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞;
    - `Boxplot` - —è—â–∏–∫ —Å —É—Å–∞–º–∏;
- `diagram_axis` ‚Äî –æ—Å—å (–∏–ª–∏ —Å–ø–∏—Å–æ–∫ –æ—Å–µ–π), –≤–¥–æ–ª—å –∫–æ—Ç–æ—Ä–æ–π –Ω—É–∂–Ω–æ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ. –î–æ—Å—Ç—É–ø–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:
    - `X` - –æ—Å—å –∞–±—Å—Ü–∏—Å—Å;
    - `Y` - –æ—Å—å –æ—Ä–¥–∏–Ω–∞—Ç;
- `path_to_save` ‚Äî –ø—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞. –ï—Å–ª–∏ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ""), –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.

–ü—Ä–∏–º–µ—Ä –≤—ã—Ö–æ–¥–∞: 
![analis](./images/analis.png)

*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:* –í—ã–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ü–≤–µ—Ç) –æ—Å—Ç–∞–µ—Ç—Å—è –∑–∞ –≤–∞–º–∏, –ø–æ–≤—Ç–æ—Ä—è—Ç—å –ø—Ä–∏–º–µ—Ä –Ω–µ –Ω–∞–¥–æ. –¢–∞–∫–∂–µ –ø–æ –∂–µ–ª–∞–Ω–∏—é –º–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª.

## –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞

### –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –ª–∏—à–Ω–µ–≥–æ

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –≤—Å—é —Å–≤–æ—é –ø–æ–ª–µ–∑–Ω–æ—Å—Ç—å, —Å –ø–æ–º–æ—â—å—é –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –±—ã–≤–∞–µ—Ç –∑–∞—Ç—Ä—É–¥–Ω–∏—Ç–µ–ª—å–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–∞–º–∏ –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–¥–µ, –∞ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ. –í–µ–¥—å –Ω–µ —Ö–æ—á–µ—Ç—Å—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Å—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –≥–¥–µ –æ–¥–∏–Ω –∏–∑ –Ω–∏—Ö –≤—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ—Ç 0. –¢–∞–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –º—ã –º–æ–∂–µ–º –∑–∞—Ö–æ—Ç–µ—Ç—å –∏—Å–∫–ª—é—á–∏—Ç—å –≤—Å–µ –≤—ã–±—Ä–æ—Å—ã –∏–∑ –Ω–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º. –†–µ–∞–ª–∏–∑—É–µ–º –¥–ª—è —ç—Ç–∏—Ö —Ü–µ–ª–µ–π —Å–ª–µ–¥—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é:

```python
def get_boxplot_outliers(
    data: np.ndarray,
    key: Callable[[Any], Any],
) -> np.ndarray:
    ...
```

–î–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º:
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è;
- –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å 1 –∏ 3 –∫–≤–∞—Ä—Ç–∏–ª–∏: $q_1$ = `data_sorted[size * 0.25]`, $q_3$ = `data_sorted[size * 0.75]`;
- –í—ã—á–∏—Å–ª–∏—Ç—å $\epsilon = (q_3 - q_1) \times 1.5$;
- –í—ã—á–∏—Å–ª–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –ª–µ–∂–∞—â–∏—Ö –≤–Ω–µ $[q_1 - \epsilon, q_3 + \epsilon]$;
- –í–µ—Ä–Ω—É—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã - –∏–Ω–¥–µ–∫—Å—ã –≤—ã–±—Ä–æ—Å–æ–≤.

–ü–æ–¥—Ä–æ–±–Ω–µ–µ –ø—Ä–æ boxplot [—Ç—É—Ç](https://ru.wikipedia.org/wiki/%D0%AF%D1%89%D0%B8%D0%BA_%D1%81_%D1%83%D1%81%D0%B0%D0%BC%D0%B8).

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —É–∫–∞–∑–∞–Ω–Ω—ã–π –æ—Ç—Ä–µ–∑–æ–∫ –≤ –æ–±—â–µ–º —Å–ª—É—á–∞–µ —è–≤–ª—è–µ—Ç—Å—è n-–º–µ—Ä–Ω–æ–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–π –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç—å—é.

–ù–∞ –≤—Ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ `data` –∏ –≤—ã–∑—ã–≤–∞–µ–º—ã–π –æ–±—ä–µ–∫—Ç `key` - —Ñ—É–Ω–∫—Ü–∏—é, –∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ (–∞–Ω–∞–ª–æ–≥–∏—è —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π `sorted`). –í—ã—Ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ - –º–∞—Å—Å–∏–≤ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤—ã–±—Ä–æ—Å–æ–≤. 

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö 

–û—Å–Ω–æ–≤–Ω–æ–π –Ω–∞—à–µ–π –∑–∞–¥–∞—á–µ–π —è–≤–ª—è–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –Ω–æ –Ω–µ –ª–æ–≥–∏—á–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∏—Ö –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º—ã –ª–∏—à–∞–µ–º —Å–µ–±—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–µ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞. –ß—Ç–æ–±—ã –≤ –±—É–¥—É—â–µ–º –æ—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞—à–µ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞, –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–¥–µ–ª–∏–º –Ω–∞—à—É –≤—ã–±–æ—Ä–∫—É –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏: –≤—ã–±–æ—Ä–∫—É –¥–ª—è –æ–±—É—á–µ–Ω–∏—è (*train*) –∏ –≤—ã–±–æ—Ä–∫—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (*test*). –í—ã–±–æ—Ä–∫—É –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –Ω–∞—à–µ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏. –í—ã–±–æ—Ä–∫—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è - –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.

–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∫–∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é. –ù–∞ –≤—Ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–¥–∞—é—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫–∏ –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –∑–Ω–∞—á–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ `points` –∏ `labels`. –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–∞–¥–∞—á–∏ –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –¥–µ–ª–µ–Ω–∏—è –≤—ã–±–æ—Ä–∫–∏ –Ω–∞ —á–∞—Å—Ç–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤, –ø–æ—Ç–æ–º—É —Ç—Ä–µ—Ç—å–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º –Ω–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥–µ—Ç —Ä–∞–∑–º–µ—Ä *train*-—á–∞—Å—Ç–∏ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö (–≤ –≤–∏–¥–µ —á–∏—Å–ª–∞ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 0 –¥–æ 1). –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–ª–∏ –≥—Ä—É–ø–ø–æ–≤—ã—Ö –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π –≤ –¥–∞–Ω–Ω—ã—Ö, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Ö –ø–µ—Ä–µ–º–µ—à–∏–≤–∞—Ç—å –ø–æ—ç—Ç–æ–º—É –ø–æ—Å–ª–µ–¥–Ω–∏–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ñ–ª–∞–≥ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è `shuffle`, –µ—Å–ª–∏ –æ–Ω `True`, —Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–º–µ—à–∞—Ç—å –¥–∞–Ω–Ω—ã–µ. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø—Ä–∏ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –∏ –µ–≥–æ –º–µ—Ç–∫–∏, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ö–∞–æ—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞—Ç—å –≤—Å–µ –º–∞—Å—Å–∏–≤—ã, –Ω–µ –æ–±—Ä–∞—â–∞—è –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≤–∑–∞–∏–º–Ω—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –º–µ—Ç–æ–∫ –∏ —Ç–æ—á–µ–∫.

–ù–∞ –≤—ã—Ö–æ–¥–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å 4 –º–∞—Å—Å–∏–≤–∞: –¥–≤–∞ *train* –º–∞—Å—Å–∏–≤–∞ - *train_points* –∏ *train_labels*, –∏ –¥–≤–∞ *test*-–º–∞—Å—Å–∏–≤–∞ - *test_points* –∏ *test_labels*.

–í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ —Ä–∞–∑–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –≤ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö *train* –∏ *test* —á–∞—Å—Ç—è—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–∞–≤–Ω—ã–º. –¢.–µ. –µ—Å–ª–∏ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –º–∞—Å—Å–∏–≤–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–Ω–∏—Ö —Ç–æ—á–µ–∫ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–∞—Å–Ω—ã—Ö —Ç–æ—á–µ–∫ —Å–æ–æ—Ç–Ω–æ—Å–∏–ª–∏—Å—å –≤ –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ 2:1, —Ç–æ –≤ *test* –∏ *train* —á–∞—Å—Ç—è—Ö —ç—Ç–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è. –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –∑–∞–ª–æ–∂–∏—Ç—å –∑–Ω–∞–Ω–∏—è –æ —Ä–µ–∞–ª—å–Ω–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –Ω–∞—à –∞–ª–≥–æ—Ä–∏—Ç–º.

–ò—Ç–∞–∫, –≤–∞—à–∞ –∑–∞–¥–∞—á–∞ - —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –º–∞—Å—Å–∏–≤–∞ –Ω–∞ train –∏ test —á–∞—Å—Ç–∏.

```python 
def train_test_split(
    features: np.ndarray,
    targets: np.ndarray,
    train_ratio: float = 0.8,
    shuffle: bool = True,
) -> tuple[np.ndarray, np.ndarray, np.ndarray, np.ndarray]:
    ...
```

## –ê–ª–≥–æ—Ä–∏—Ç–º—ã

### KNN –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

–ê–ª–≥–æ—Ä–∏—Ç–º KNN —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–µ –±–ª–∏–∑–æ—Å—Ç–∏ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å –Ω–µ –∑–Ω–∞–µ—Ç, —Å–ø–∏—Å–∞–Ω –ª–∏ –∫–æ–Ω—Ç–µ—Å—Ç –∏–ª–∏ –Ω–µ—Ç, —Ç–æ –Ω–∞–ª–∏—á–∏–µ –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–ø–∏—Å–∞–Ω–Ω—ã—Ö –Ω–µ–¥–∞–≤–Ω–∏—Ö –∫–æ–Ω—Ç–µ—Å—Ç–æ–≤, –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∏ —ç—Ç–æ—Ç —Ç–æ–∂–µ —Å–ø–∏—Å–∞–Ω. –§–æ—Ä–º–∞–ª—å–Ω–æ –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

- –î–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º–æ–π —Ç–æ—á–∫–∏ ùë• –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –≤—Å–µ—Ö —Ç–æ—á–µ–∫ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏:
$$\Rho = \{ \rho(\vec{x}, \vec{x_i}) | \vec{x_i} \in X^l, i = \overline{1,l} \}$$
- –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞—é—Ç—Å—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é;
- –í—ã–±–∏—Ä–∞–µ—Ç—Å—è ùëò –±–ª–∏–∂–∞–π—à–∏—Ö —Ç–æ—á–µ–∫ (—Å –Ω–∞–∏–º–µ–Ω—å—à–∏–º–∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è–º–∏) ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π;
- –£–ø–æ—Ä—è–¥–æ—á–∏–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é: $\rho(\vec{x}, \vec{x_1}) \le ... \le \rho(\vec{x}, \vec{x_l})$;
- –í—ã–±–µ—Ä–µ–º $k$ —Ç–æ—á–µ–∫, –±–ª–∏–∂–∞–π—à–∏—Ö –≤ —Å–º—ã—Å–ª–µ –º–µ—Ç—Ä–∏–∫–∏ $\rho$ –∫ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º–æ–π —Ç–æ—á–∫–µ $\vec{x}$;
- –í—ã—á–∏—Å–ª–∏–º –≤–µ–ª–∏—á–∏–Ω—É $label_x = \argmax_{c \in C}{\sum_{i = 1}^k{[y_i = c]}}$, –≥–¥–µ $C$ - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–æ–≤ (–≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–∑ –¥–≤—É—Ö —Ü–≤–µ—Ç–æ–≤: –∫—Ä–∞—Å–Ω–æ–≥–æ –∏ —Å–∏–Ω–µ–≥–æ), $c$ - —ç–ª–µ–º–µ–Ω—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Å–æ–≤, $y_i$ - –º–µ—Ç–∫–∞ —Ç–æ—á–∫–∏ $\vec{x_i}$, —Ç.–µ. —Ü–≤–µ—Ç —Ç–æ—á–∫–∏ $\vec{x_i}$, –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —Å–∫–æ–±–∫–∏ - —Ñ—É–Ω–∫—Ü–∏—è-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä, —Ç.–µ. —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 1, –µ—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ –≤ —Å–∫–æ–±–∫–∞—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–æ, –∏–Ω–∞—á–µ - 0;



### –í–∑–≤–µ—à–µ–Ω–Ω—ã–π KNN –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

–ü—Ä–∏–Ω—Ü–∏–ø –≤–∑–≤–µ—à–µ–Ω–Ω–æ–≥–æ KNN –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ–±—ã —É–º–Ω–µ–µ —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π. –í–µ–¥—å, —á–µ–º –¥–∞–ª—å—à–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Å–æ—Å–µ–¥, —Ç–µ–º –º–µ–Ω—å—à–µ –æ–Ω –¥–æ–ª–∂–µ–Ω –≤–ª–∏—è—Ç—å –Ω–∞ –Ω–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ. –¢–æ –µ—Å—Ç—å, –µ—Å–ª–∏ —á–µ–ª–æ–≤–µ–∫ –ø–∞—Ä—É —Ä–∞–∑ –¥–∞–≤–Ω–æ —Å–ø–∏—Å–∞–ª, –∞ –ø–æ—Ç–æ–º –Ω–µ —Å–ø–∏—Å—ã–≤–∞–ª, —Ç–æ –º–æ–∂–µ—Ç –æ–Ω –∏—Å–ø—Ä–∞–≤–∏–ª—Å—è –∏ –ø–µ—Ä–µ—Å—Ç–∞–ª –∫–∞—Ç–∞—Ç—å. –ß—Ç–æ–±—ã —É—á–∏—Ç—ã–≤–∞—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –≤–≤–æ–¥–∏—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è –≤–µ—Å–æ–≤, –∫–æ—Ç–æ—Ä–∞—è —Å—Ö–æ–∂–∞ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –≤–µ—Å–æ–≤ –¥–ª—è –Ω–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ —Å–µ–º–µ—Å—Ç—Ä–∞. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –ø–æ–ª—É—á–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º:

- –û–ø—Ä–µ–¥–µ–ª–∏–º $\Rho = \{ \rho(\vec{x}, \vec{x_i}) | \vec{x_i} \in X^l, i = \overline{1,l} \}$ - –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –æ—Ç —Ç–æ—á–∫–∏ $\vec{x}$ –¥–æ —Ç–æ—á–µ–∫ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏;
- –û–ø—Ä–µ–¥–µ–ª–∏–º $W = \{w_i =  K(\frac{\rho(x, x_i)}{h}) | \vec(x_i) \in X^l, i = \overline{1, l}\}$ - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–µ—Å–æ–≤, —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–∏ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏, –≤—Å–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è–º –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø—É–Ω–∫—Ç–∞. –ì–¥–µ $K(\frac{\rho(x, x_i)}{h})$ - —è–¥—Ä–æ, –Ω–µ–≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–∞—è, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è, –≥–ª–∞–¥–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è, $h$ - —à–∏—Ä–∏–Ω–∞ –æ–∫–Ω–∞ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è;
- –∞ –µ—Å–ª–∏ –∫–æ–¥ –ø–∏—à–µ—Ç LLM, —Ç–æ –Ω–∞–¥–æ –æ—Å—Ç–∞–≤–∏—Ç—å —Å–º–µ—à–Ω–æ–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π;
- –£–ø–æ—Ä—è–¥–æ—á–∏–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é: $\rho(\vec{x}, \vec{x_1}) \le ... \le \rho(\vec{x}, \vec{x_l})$;
- –í—ã–±–µ—Ä–µ–º $k$ —Ç–æ—á–µ–∫, –±–ª–∏–∂–∞–π—à–∏—Ö –≤ —Å–º—ã—Å–ª–µ –º–µ—Ç—Ä–∏–∫–∏ $\rho$ –∫ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º–æ–π —Ç–æ—á–∫–µ $\vec{x}$;
- –í—ã—á–∏—Å–ª–∏–º –≤–µ–ª–∏—á–∏–Ω—É $label_x = \argmax_{c \in C}{\sum_{i = 1}^k{[y_i = c]w_i}}$, –≥–¥–µ $C$ - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–æ–≤ (–≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–∑ –¥–≤—É—Ö —Ü–≤–µ—Ç–æ–≤: –∫—Ä–∞—Å–Ω–æ–≥–æ –∏ —Å–∏–Ω–µ–≥–æ), $c$ - —ç–ª–µ–º–µ–Ω—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Å–æ–≤, $y_i$ - –º–µ—Ç–∫–∞ —Ç–æ—á–∫–∏ $\vec{x_i}$, —Ç.–µ. —Ü–≤–µ—Ç —Ç–æ—á–∫–∏ $\vec{x_i}$, –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —Å–∫–æ–±–∫–∏ - —Ñ—É–Ω–∫—Ü–∏—è-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä, —Ç.–µ. —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ 1, –µ—Å–ª–∏ —É—Å–ª–æ–≤–∏–µ –≤ —Å–∫–æ–±–∫–∞—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–æ, –∏–Ω–∞—á–µ - 0;
- –í—ã—á–∏—Å–ª–µ–Ω–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ $label_x$ –∏ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ–º.

–û—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —è–¥—Ä–æ –∏ —à–∏—Ä–∏–Ω—É –æ–∫–Ω–∞ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å–ª—É—á–∞—é —Å –Ω–µ–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–µ–π –≤–æ–∑—å–º—ë–º –≤ –∫–∞—á–µ—Å—Ç–≤–µ —è–¥—Ä–∞ —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º–æ–µ [—è–¥—Ä–æ –ï–ø–∞–Ω–µ—á–Ω–∏–∫–æ–≤–∞](https://ru.wikipedia.org/wiki/%D0%AF%D0%B4%D1%80%D0%BE_(%D1%81%D1%82%D0%B0%D1%82%D0%B8%D1%81%D1%82%D0%B8%D0%BA%D0%B0)):
$$
\begin{equation*}
K(x) = 
 \begin{cases}
   \frac{3}{4}(1 - x^2), |x| \le 1\\
   0, |x| > 1
 \end{cases}
\end{equation*}
$$

–ê —á—Ç–æ–±—ã –Ω–µ –¥—É–º–∞—Ç—å –Ω–∞–¥ —à–∏—Ä–∏–Ω–æ–π –æ–∫–Ω–∞ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è –ø—Ä–∏–≤—è–∂–µ–º –µ–µ –∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π $k$, –ø—É—Å—Ç—å $h = \rho(\vec{x}, \vec{x_k})$. –¢–∞–∫ –º—ã —É–±—å–µ–º 2—Ö –∑–∞–π—Ü–µ–≤, —Å –æ–¥–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã —Ç–µ–ø–µ—Ä—å –Ω–∞–º –Ω–µ –Ω–∞–¥–æ –æ—Ç–¥–µ–ª—å–Ω–æ –µ–µ –ø–æ–¥–±–∏—Ä–∞—Ç—å, –∞ —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –º—ã –ø–æ–ª—É—á–∏–º –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –≤–µ–¥—å –ø—Ä–∏ –¥–∞–Ω–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ —à–∏—Ä–∏–Ω–∞ –æ–∫–Ω–∞ –±—É–¥–µ—Ç —Å–≤–æ—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ $x$.

```python
class WeightedKNearestNeighbors:
    def __init__(
        self, 
        n_neighbors: int = 20, 
        calc_distances: Callable = euclidean_dist,
    ):
       ...

    def fit(
        self, 
        X_train: np.ndarray, 
        y_train: np.ndarray,
    ):
        ...

    def predict(self, X_test: np.ndarray):
        ...
```
 - `n_neighbors` - —á–∏—Å–ª–æ –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π;
 - `calc_distances` - —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Å—á–∏—Ç–∞—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è;
 - `X_train`, `y_train` - –æ–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞;
 - `X_test` - —Ç–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞.

*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:*: —Å–∏–≥–Ω–∞—Ç—É—Ä—É `calc_distances` –≤—ã–±–µ—Ä–µ—Ç–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ. 

## –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞

–í –∫–∞—á–µ—Å—Ç–≤–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑—É–µ–º –º–µ—Ç—Ä–∏–∫—É "—Ç–æ—á–Ω–æ—Å—Ç—å":

$$accuracy = \frac{1}{n}\sum_{i=1}^n{[y_i = prediction_i]}$$

```python 
def accuracy(
    true_targets: np.ndarray, 
    prediction: np.ndarray, 
) -> float:
    ...
```

## –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ö–∞–∂–µ—Ç—Å—è, –º—ã –∑–∞–±—ã–ª–∏ –ø—Ä–æ —Å–∞–º–æ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ - –ø—Ä–æ –∞–Ω–∏–º–∞—Ü–∏–∏! –ß—Ç–æ –∂–µ —Å—Ç–æ–∏—Ç —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å. –î–∞–≤–∞–π—Ç–µ –∞–Ω–∏–º–∏—Ä—É–µ–º —Ä–∞–±–æ—Ç—É –∞–ª–≥–æ—Ä–∏—Ç–º–∞ KNN. –î–ª—è —ç—Ç–æ–≥–æ –¥–æ–±–∞–≤–∏–º –∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ —Ä–∞–±–æ—Ç—É –∞–ª–≥–æ—Ä–∏—Ç–º–∞ (–∫–∞–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –≤ –∫–∞–∫–æ–º –≤–∏–¥–µ —Ä–µ—à–∞–π—Ç–µ —Å–∞–º–∏).

–ê–Ω–∏–º–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ–±–ª–∞—Å—Ç—å, –≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞—Ö–æ–¥—è—Ç—Å—è –±–ª–∏–∂–∞–π—à–∏–µ —Å–æ—Å–µ–¥–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–ª—É—á–∞—è, –∞ —Ç–∞–∫–∂–µ —É–∫–∞–∑–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –±—ã–ª –≤—ã–±—Ä–∞–Ω–∞ –º–µ—Ç–∫–∞. –¢–∞–∫–∂–µ –∞–Ω–∏–º–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è, –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω –Ω–µ –ø—É—Å—Ç–æ–π `path_to_save`.

```python

class AnimationKNN:
    def __init__(self):
        ...
    
    def create_animation(
        self,
        knn: WeightedKNearestNeighbors | KNearestNeighbors,
        true_targets: np.ndarray, 
        path_to_save: str = "",
    ) -> FuncAnimation:
        ...
```

–ü—Ä–∏–º–µ—Ä –∞–Ω–∏–º–∞—Ü–∏–∏:

![animate_knn](./images/knn_animate.gif)

*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:* —Å–ª–µ–¥–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä—É —Ç–æ—á—å –≤ —Ç–æ—á—å –æ–ø—è—Ç—å –∂–µ –Ω–µ –Ω–∞–¥–æ (–¥–∞–∂–µ –Ω–µ–ª—å–∑—è). –í—ã–±–µ—Ä–µ—Ç–µ —Å–∞–º–∏, –∫–∞–∫ –≤—ã —Ö–æ—Ç–∏—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å.

## –ó–∞–¥–∞–Ω–∏–µ

–í –¥–∞–Ω–Ω–æ–π –¥–æ–º–∞—à–Ω–µ–π —Ä–∞–±–æ—Ç–µ –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–ø–∏—Å–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª. 

- –†–∞–∑—Ä–∞–±–æ—Ç–∞–π—Ç–µ —Ñ–∞–π–ª–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É;
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö;
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤;
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é —Ä–∞–∑–±–∏–µ–Ω–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ–±—É—á–∞—é—â—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫–∏;
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ –∞–ª–≥–æ—Ä–∏—Ç–º KNN –∏ –∞–ª–≥–æ—Ä–∏—Ç–º –≤–∑–≤–µ—à–µ–Ω–Ω–æ–≥–æ KNN;
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ –æ–ø–∏—Å–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞;
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞;
- –ò –∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –ß–µ—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞, —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ—Å—Ç—å –∫–æ—Ç–æ—Ä–æ–π –≤—ã –º–æ–∂–µ—Ç–µ –æ–±–æ—Å–Ω–æ–≤–∞—Ç—å;
- –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∫–æ–¥–∞: –≤–∞—à –∫–æ–¥ –¥–æ–ª–∂–µ–Ω –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ª–∏–Ω—Ç–µ—Ä–æ–º flake8, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–º –∫–æ–Ω—Ñ–∏–≥ `.flake8`, –∫–æ—Ç–æ—Ä—ã–π –ª–µ–∂–∏—Ç –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è;
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤–µ—Å—å –æ–ø–∏—Å–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª;
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω—ã, –Ω–æ –∏ –Ω–∞ –¥—Ä—É–≥–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö (—á–∏—Å–ª–æ –∫–ª–∞—Å—Å–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ 2);
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞–ø–∏—Å–∞–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π NumPy —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ü–∏–∫–ª–æ–≤; 
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–∞–Ω–∏–ª—å–Ω–æ–≥–æ python, numpy –∏ matplotlib; 
- –°–µ–º–∏–Ω–∞—Ä–∏—Å—Ç –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–±–µ–¥–∏—Ç—å—Å—è –≤ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤–∞—à–µ–≥–æ –∫–æ–¥–∞. –≠—Ç–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–∞–ø–∏—Å–∞–≤ —Å–∫—Ä–∏–ø—Ç `demo.py`, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–µ—à–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—É—é –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É, –∏—Å–ø–æ–ª—å–∑—É—è –≤–µ—Å—å –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –≤—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (–ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—É–Ω–∫—Ç –∑–∞–¥–∞–Ω–∏—è). –¢–∞–∫–∂–µ –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —ç—Ç–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ, –Ω–∞–ø–∏—Å–∞–≤ —é–Ω–∏—Ç-—Ç–µ—Å—Ç—ã –∫ –≤–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ, –∏—Å–ø–æ–ª—å–∑—É—è Pytest. –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ —Ä–∞–±–æ—Ç–µ —Å Pytest –º–æ–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å [—Ç—É—Ç](https://habr.com/ru/articles/448782/);

–ù—É —á—Ç–æ –∂–µ –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ–∂–µ–ª–∞—Ç—å –≤–∞–º —É–¥–∞—á–∏ –Ω–∞ —Å–¥–∞—á–µ.
