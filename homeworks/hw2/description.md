# Ним

Ним — игра, в которой два игрока по очереди берут предметы, разложенные на несколько кучек. За один ход может быть взято любое количество предметов (больше нуля) из одной кучки. Выигрывает игрок, взявший последний предмет.

Ваша задача - реализовать игру Ним таким образом, чтобы пользователь состязаться с компьютером.

## Струкрутра проекта

Для структурированности решения вам предлжена следующая структура проекта:

```console
hw2
├───nim_game
│   ├───agents
│   │   ├───__init__.py
│   │   └───agents.py
│   ├───common
│   │   ├───__init__.py
│   │   ├───enumerations.py
│   │   ├───event_logger.py
│   │   └───model.py
│   ├───environments
│   │   ├───__init__.py
│   │   └───environment_nim.py
│   ├───games
│   │   ├───__init__.py
│   │   └───game_nim.py
├───tests
├───game_loop.py
├───nim.py
├───utils.py
├───game_config.json
└───description.md
```

Описание:
- **agents** - в этой папке лежат исходные кода агента, т.е. бота, который будет состязаться с игроком в умении убирать камни из кучек;
- **common** - в этой папке лежат общие сущности: перечисления, структуры данных и средства логирования;
- **environments** - в этой папке лежит исходник класса, описывающего кучки камней;
- **games** - в этой папке лежит исходник интерфейса игры;
- **tests** - тесты;
- **game_loop.py** - файлы с исходным кодом игрового цикла;
- **nim.py** - скрипт для запуска игры;
- **utils.py** - файл со вспомогательными сущностями;
- **game_config.json** - базовые настройки игры;
- **description.md** - описания задания;

## Описание задания

В данном задании вам предложено реализовать три класса: Agent из файла agent.py, EnvironmentNim из файла environment_nim.py и GameNim из файла GameNim. Ниже приведены описания классов:

### Agent

Класс, реализующий поведение бота. 

- Инициализируется единствынным параметром - `level`, который задается строковым литералом. level, будучи заданным строкой, может принимать исключительно значения, описанные в перечислении `AgentLevel` из файла enumerations.py. Если значение level отлично от одного из значений перечисления - необходимо возбудить ValueError;

- Также в данном классе присутствует метод `make_step()`. На вход этому методу приходит список целых чисел - описание кучек с камнями, где i-ый элемент соответствет количеству камней в i-ой кучке. Бот должен ходить в зависимости от заданного уровня сложности:
    - Если level == EASY, бот должен убрать случайное допустимое число камней из случайно непустой кучки;
    - Если level == HARD, бот должен делать шаг в соответствии с оптимальной стратегией (подумайте над ней);
    - Если level == NORMAL, бот с вероятность 50% делает оптимальный шаг, в ином случае - случайный шаг, как на уровне EASY;

    Замечание: допустимым считается число камней, отличное от нуля и не превышающее число камней в кучке;

    Данный метод возвращает структуру `NimStateChange`, описывающая ход бота. Эта структура содержит два поля: heap_id - индекс уменьшаемой кучки, decrease - число камней, на которое необходимо уменьшить кучку.

### EnvironmentNim

Класс для хранения и взаимодействия с кучками камешков.

- Инициализируется целым числом `heaps_amount`, определяющим количество кучек. Количество кучек должно быть не меньше 2 и не больше 10, иначе происходит возбуждение исключения ValueError.

- В момент инициализации создается список длины heaps_amount, который заполняется случайными целыми числами в диапазоне от 1 до 10;

- Метод `get_state` возвращает список интов - информацию о заполненности кучек;

- Метод `change_state()` позволяет изменить количество камней в одной из кучек. На вход принимается структура state_change. Если индекс кучки, заданный в этой структуре, является отрицательным или превышает число элементов кучек, необходимо возбудить исключение ValueError. Если количество камней, на которое происходит уменьшение, меньше 1 или больше текущего числа камней в уменьшаемой кучке - необходимо возбудить исключение.

### GameNim

Интерфейс игры. 

- Инициализируется путем до конфигурационного файла следующего формата:

    ```json
    {
        "heaps_amount": 5,
        "opponent_level": "easy"
    }
    ```

    Конфиг задает число кучек и уровень компьютера. В процессе инициализации необходимо считать информацию из файла и проинициализировать экземпляр класса EnvironmentNim и Agent;

- Метод `make_steps()` позволяет сделать ход пользователю. На вход приниматеся структура `NimStateChange`. После чего делается ход пользователя и ход компьютера. Результат выполнения операции - структура GameState, описывающая состояние игры. Если на данном ходе игра закончилась, в этой структуре заполняется поле winner, если игра не закончена необходимо заполнить поля, с информацией о ходе компьютера и с информацией о текущем состоянии кучек.

- Метод `is_game_finished()` позволяет узнать, закончилась ли игра, или нет. Игра считатется завершенной, когда ни в одной из кучек нет камней;

## Оценивание

Используйте flake8 и pytest для самопроверки. Работы, с непройденными тестами или с неправильным оформлением проверяться не будут. Оценка выставляется семинаристов после очной сдачи.
